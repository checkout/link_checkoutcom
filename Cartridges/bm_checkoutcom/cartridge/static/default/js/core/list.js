"use strict";function loadTranslations(){window.ckoLang=JSON.parse(jQuery('[id="translationStrings"]').val())}function buildTabs(){var t='[id="'+getCookie("ckoTabs")+'"]';jQuery(t).removeClass("table_tabs_dis").addClass("table_tabs_en"),jQuery(t).parent("td").removeClass("table_tabs_dis_background").addClass("table_tabs_en_background")}function getCookie(t){for(var n=t+"=",e=decodeURIComponent(document.cookie).split(";"),o=0;o<e.length;o++){for(var a=e[o];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(n))return a.substring(n.length,a.length)}return""}function getTransactions(t){var n=jQuery('[id="transactionsControllerUrl"]').val()+"?page="+window.ckoTransactionsTable.options.ajaxParams.page+"&size="+window.ckoTransactionsTable.options.ajaxParams.size+"&year="+document.getElementById("year").value;jQuery.ajax({type:"POST",url:n,success:function(n){t(n)},error:function(t,n,e){console.log(e)}})}function initTable(){window.ckoTransactionsTable=new Tabulator("#transactions-table",{index:"id",responsiveLayout:!0,selectable:"highlight",headerFilterPlaceholder:">",placeholder:window.ckoLang.noResults,layout:"fitColumns",pagination:"remote",ajaxURL:jQuery('[id="transactionsControllerUrl"]').val(),ajaxParams:{year:document.getElementById("year").value},paginationSize:document.getElementById("row").value||50,columns:getTableColumns(),langs:getTableStrings(),tableBuilt:function(){setPagination(this)}})}function getTableStrings(){return getTableLocale(),{tableLocale:{columns:{id:window.ckoLang.rowId,order_no:window.ckoLang.orderNo,transaction_id:window.ckoLang.transactionId,payment_id:window.ckoLang.paymentId,amount:window.ckoLang.amount,currency:window.ckoLang.currency,date:window.ckoLang.date,type:window.ckoLang.type,opened:window.ckoLang.opened,processor:window.ckoLang.processor,actions:window.ckoLang.actions},pagination:{first:window.ckoLang.first,first_title:window.ckoLang.firstTitle,last:window.ckoLang.last,last_title:window.ckoLang.lastTitle,prev:window.ckoLang.prev,prev_title:window.ckoLang.prevTitle,next:window.ckoLang.next,next_title:window.ckoLang.nextTitle}}}}function getTableLocale(){var t=jQuery('[id="currentLocale"]').val();return t+"-"+t}function setPagination(t){jQuery(".transactions-table-controls .transactions-table-pager").change((function(){var n=jQuery(this).val();jQuery(this).val(n),t.setPageSize(n)}))}function setYear(){jQuery(".transactions-table-controls-year .transactions-table-pager-year").change((function(){initTable()}))}function setYearDropdown(){for(var t=jQuery('[id="startFilterYear"]').val(),n=(new Date).getFullYear()+1,e=[];parseInt(t)<parseInt(n);){var o=t;t=(parseInt(t)+1).toString(),e.push(o+"-"+t)}var a=document.getElementById("year");for(const t of e){var i=document.createElement("option");i.value=t,i.text=t,a.appendChild(i)}var r=e[e.length-1];document.getElementById("year").value=r}function getTableColumns(){return[{title:"ID",field:"id",visible:!1},{title:"Order No.",field:"order_no",width:120,formatter:"html",headerFilter:"input"},{title:"Transaction ID",field:"transaction_id",headerFilter:"input"},{title:"Action ID",field:"action_id",headerFilter:"input"},{title:"Amount",field:"amount",headerFilter:"input",formatter:function(t,n,e){var o=t.getRow().getData();return t.getValue()+" "+o.currency}},{title:"Currency",field:"currency",visible:!1},{title:"Date",field:"creation_date",headerFilter:"input"},{title:"Type",field:"type",headerFilter:"input"},{title:"State",field:"opened",formatter:"tickCross",visible:!1},{title:"Processor",field:"processor",width:200,headerFilter:"input"},{title:"Actions",field:"actions",width:230,headerSort:!1,align:"center",formatter:function(t,n,e){return getButtonsHtml(t)}}]}function getButtonsHtml(t){var n,e=t.getRow().getData(),o="",a=e.amount.toString();return e.transaction_id&&-1!=e.transaction_id.indexOf("pay_")?n=e.transaction_id:e.payment_id&&-1!=e.payment_id.indexOf("pay_")&&(n=e.payment_id),"NAS"===e.abcOrNasEnabled?JSON.parse(e.opened)?("AUTH"===e.type&&(o+='<button type="button" id="void-button-'+n+'" class="btn btn-default ckoAction">'+window.ckoLang.void+"</button>",o+='<button type="button" id="capture-button-'+n+'" class="btn btn-info ckoAction">'+window.ckoLang.capture+"</button>"),"CAPTURE"===e.type&&(a!==e.captured_amount?(o+='<button type="button" id="capture-button-'+n+'" class="btn btn-info ckoAction">'+window.ckoLang.capture+"</button>",o+='<button type="button" id="refund-button-'+n+'" class="btn btn-secondary ckoAction">'+window.ckoLang.refund+"</button>"):o+='<button type="button" id="refund-button-'+n+'" class="btn btn-secondary ckoAction">'+window.ckoLang.refund+"</button>")):a!==e.captured_amount&&0!=e.refundable_amount?(o+='<button type="button" id="capture-button-'+n+'" class="btn btn-info ckoAction">'+window.ckoLang.capture+"</button>",o+='<button type="button" id="refund-button-'+n+'" class="btn btn-secondary ckoAction">'+window.ckoLang.refund+"</button>"):a===e.captured_amount&&0!=e.refundable_amount?o+='<button type="button" id="refund-button-'+n+'" class="btn btn-secondary ckoAction">'+window.ckoLang.refund+"</button>":a!==e.captured_amount&&0==e.refundable_amount&&"AUTH_REVERSAL"!==e.type?o+='<button type="button" id="capture-button-'+n+'" class="btn btn-info ckoAction">'+window.ckoLang.capture+"</button>":o+='<div class="ckoLocked">&#x1f512;</div>':JSON.parse(e.opened)&&"CREDIT"!==e.type?("AUTH"===e.type&&(o+='<button type="button" id="void-button-'+n+'" class="btn btn-default ckoAction">'+window.ckoLang.void+"</button>",o+='<button type="button" id="capture-button-'+n+'" class="btn btn-info ckoAction">'+window.ckoLang.capture+"</button>"),"CAPTURE"===e.type&&(o+='<button type="button" id="refund-button-'+n+'" class="btn btn-secondary ckoAction">'+window.ckoLang.refund+"</button>")):0!=e.refundable_amount?o+='<button type="button" id="refund-button-'+n+'" class="btn btn-secondary ckoAction">'+window.ckoLang.refund+"</button>":o+='<div class="ckoLocked">&#x1f512;</div>',o}document.addEventListener("DOMContentLoaded",(function(){loadTranslations(),buildTabs(),setYearDropdown(),initTable(),setYear()}),!1);